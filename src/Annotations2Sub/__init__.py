# -*- coding: utf-8 -*-

"""ä¸‹è½½å’Œè½¬æ¢ Youtube æ³¨é‡Š"""

__version__ = "2.20.0"

"""
                                             xml.
                                             etree.
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    ElementTree.  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚  f.read()  â”‚        â”‚    fromstring()  â”‚         â”‚     Parse()
â”‚ Annotations.xml â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ String â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Element â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚            â”‚        â”‚                  â”‚         â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                                                   â–¼
                                                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                         â”‚                  â”‚
                                                                         â”‚ List[Annotation] â”‚
                                                                         â”‚                  â”‚
                                                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚                 â”‚  finally   â”‚        â”‚  str(Sub)  â”‚             â”‚  Convert()    â”‚
â”‚ Annotations.ass â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ String â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ List[Event] â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                 â”‚            â”‚        â”‚            â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

https://www.youtube.com/channel/UCe4QujtMby3h6dge1eYaPig
åœ¨ 2019 å¹´çš„æŸä¸€å¤©, æˆ‘åœ¨ Youtube å¬æ­Œ, å‘ç°å­—å¹•æ²¡äº†.
ä»è¯„è®ºåŒºæˆ‘å¾—çŸ¥: ã€Œ å¾ 2019 å¹´ 1 æœˆ 15 æ—¥èµ·ï¼Œæˆ‘å€‘å°‡ä¸å†å°è§€çœ¾é¡¯ç¤ºç¾æœ‰çš„è¨»è§£ã€‚æ‰€æœ‰çš„ç¾æœ‰è¨»è§£éƒ½å°‡ç§»é™¤ã€‚ã€
æˆ‘å½“å³ç ´å£å¤§éª‚è°·æ­Œ.
ä½†æˆ‘ç›´è§‰å‘Šè¯‰æˆ‘åº”è¯¥æœ‰äººå­˜æ¡£,
è¿˜çœŸçš„æœ‰! é¸£è°¢: https://archive.org/details/youtubeannotations
æˆ‘å°è¯•å°†å…¶è½¬æ¢ä¸ºæˆ‘ç†Ÿæ‚‰çš„ Advanced SubStation Alpha å­—å¹•, æˆ‘åœ¨æœç´¢å¼•æ“æŸ¥æ‰¾å‘€æ‰¾, 
æ‰¾åˆ°äº† https://github.com/nirbheek/youtube-ass (è‡´è°¢)
ä½†æ˜¯ä»–å¹¶ä¸æ˜¯ä¸å¥½ç”¨, æ˜¯å‹æ ¹å°±æ²¡æ³•ç”¨.
æˆ‘æ”¹å‘€æ”¹, ä½†æ˜¯æˆ‘å…¶å®å¹¶ä¸ä¼šç¼–ç¨‹, ä½†æ˜¯æˆ‘ä¼šè°·æ­Œ, è®©ä»–å¯ä»¥è¿è¡Œä¹Ÿæ²¡æœ‰èŠ±è´¹å¤ªé•¿çš„æ—¶é—´
ä½†æ˜¯ä»–å¹¶ä¸è®©äººæ»¡æ„, æ²¡æœ‰é¢œè‰², åªæœ‰å­—å¹•, å¾ˆä¸çˆ½.
æˆ‘ä»”ç»†é˜…è¯»äº†ä»–çš„æºç , å‘ç°å®ç°å¾ˆæ¶å¿ƒ, ç«Ÿç„¶ç”¨æ ·å¼æ¥å®ç°å®šä½, è€Œä¸”å¹¶ä¸æ˜¯ç›®å‰çš„äº‹å®æ ‡å‡†(Aegisub)
ä½†æ˜¯æ‹œå…¶æ‰€è‡´æˆ‘è„‘å†…æœ‰äº†å¤§æ¦‚çš„æ€è·¯, äºæ˜¯æˆ‘å†³å®šç ¸äº†é‡å†™ä¸€ä¸ª :-)
å›è¿‡å¤´æ¥, è¿™ä¸ªè¿‡ç¨‹è®©æˆ‘å­¦ä¼šäº†ç¼–ç¨‹.

æ­¤é¡¹ç›®æ—©æœŸ(8e2d8eb ç¬¬ä¸€ä¸ªå‹‰å¼ºå¯ç”¨çš„ç‰ˆæœ¬)å‚ç…§ https://github.com/nirbheek/youtube-ass å®ç°äº†ä¸€ä¸ªç®€å•çš„è½¬æ¢å™¨, 
å‚ç…§ https://github.com/weizhenye/ASS/wiki/ASS-å­—å¹•æ ¼å¼è§„èŒƒ å®ç°äº†ä¸€ä¸ªç®€å•çš„ Advanced SubStation Alpha ç”Ÿæˆå™¨
ä½¿ç”¨ "æ ·å¼è¦†å†™ä»£ç " å®ç°äº†å®šä½å’Œé¢œè‰²
ä¹‹å(a649956 åº†ç¥ä¸€ä¸‹), ä½¿ç”¨ "ç»˜å›¾æ¨¡å¼" å®ç°äº† "popup" æ ·å¼
åœ¨ https://invidious.io/ å’Œ FFmpeg çš„å¸®åŠ©ä¸‹, å®ç°äº†ç®€å•çš„è§†é¢‘é¢„è§ˆ
ä¹‹å, è„šæœ¬é€æ­¥å®Œå–„, å®Œæˆäº† https://www.bilibili.com/video/BV1Ff4y1t7Dj
ä½†æ˜¯è¿˜æ˜¯æœ‰äº›é—æ†¾
---ä»¥ä¸‹æ˜¯æœ‰ç±»ä¼¼é—®é¢˜çš„è§†é¢‘ï¼Œä»¥åˆ¶è¡¨ç¬¦åˆ†éš”---
videoId	title
g-0i6MOh7n0	å¿—æ–¹ã‚ãã“ - ãƒ©ãƒ»ã‚·ã‚§ãƒ¼ãƒ« ä¸­æ–‡å­—å¹•(Chinese Translation)
aaLI3ErnHQg	å¿—æ–¹ã‚ãã“ - EXEC_HARMONIUS/. ä¸­æ–‡å­—å¹•(Chinese Translation)
sgeXEwVWnpI	å¿—æ–¹ã‚ãã“ - EXEC_over.METHOD_SUBLIMATION/. ~omness chs ciel sos infel  ä¸­æ–‡å­—å¹•(Chinese Translation)
R4CqsDTnT60	å¿—æ–¹ã‚ãã“ - Ec Tisia ï½Tarifaï½ ä¸­æ–‡å­—å¹•(Chinese Translation)
---ä»¥ä¸Šæ˜¯æœ‰ç±»ä¼¼é—®é¢˜çš„è§†é¢‘ï¼Œä»¥åˆ¶è¡¨ç¬¦åˆ†éš”---
è¯´å®è¯æˆ‘ä¸æƒ³å®ç°æ¶å¿ƒçš„ CSS å®šä½
æ›´ä½•å†µ annotationlib éƒ½æ²¡æœ‰æ­£ç¡®å®ç°å®šä½

---

ä½œä¸ºæˆ‘çš„ç¬¬ä¸€ä¸ªä»£ç , æˆ‘ä¸€ç›´æƒ³è®©å…¶è¶‹äºå®Œç¾.
é¦–å…ˆæƒ³çš„æ˜¯å‚è€ƒ https://github.com/isaackd/annotationlib (è‡´è°¢), å°† Annotations æŠ½æˆä¸€ä¸ªç®€å•çš„ç»“æ„, 
ä¸è„šæœ¬ç”Ÿæˆå™¨(è½¬æ¢å™¨)è§£è€¦, ç»“æœå¹¶æ²¡æœ‰è®©äº‹æƒ…å˜ç®€å•. (2020)
ä¹‹åè¿˜å°è¯•è¿‡å®ç° speech æ ·å¼, æŠŠäº‹æƒ…å¼„å¾—ä¸€å›¢ç³Ÿ
è¿˜å°è¯•è¿‡æ‰”æ‰ invidious , å‘ç°æˆ‘ç®€ç›´åƒä¸ªshaberhu (2021)
åªå¥½ä½œç½¢, ä¸Šå­¦å»äº†.
...
æ‹œå¥¥å¯†å…‹æˆæ‰€èµè‡ªä» 2022 å¹´æˆ‘å·²ç»æœ‰åŠå¹´å‘†åœ¨å®¶é‡Œäº†, æˆ‘æœ‰äº†æ—¶é—´å¯ä»¥ä¸€ç›´æŠ˜è…¾ä»£ç , æˆ‘å†³å®šå†æ¬¡æŒ‘æˆ˜è¿™ä¸ªç›®æ ‡.
é¦–å…ˆ, æˆ‘ä¾ç…§å†™ Go çš„ç»éªŒå°†è„šæœ¬æ‹†æˆäº†æ¨¡å—, ç¼–å†™å•å…ƒæµ‹è¯•, è¿›è¡Œç±»å‹æ£€æŸ¥, ä¸€é”®æ ¼å¼åŒ–
ç„¶å, å°è¯•å°† Annotations æŠ½æˆä¸€ä¸ªç®€å•çš„ç»“æ„
æœ€å, å¯¹å…¶è¿›è¡Œè¯¦å°½çš„æ³¨é‡Š, åˆ°ç›®å‰ä¸ºæ­¢çœ‹èµ·æ¥ä¸é”™.
...
å·®ä¸å¤šå®Œäº‹å„¿äº†, å‰©ä¸‹çš„æ—¶é—´å°±æ˜¯ç»´æŠ¤ä»£ç äº†.

---

æ²¡æƒ³åˆ°è¿˜æœ‰ https://github.com/po5/assnotations
...

---

åœ¨å¤±çœ çš„å¤œæ™šæ€ç»ªé£æ‰¬, æˆ‘åœ¨ Internet Archive ä¸Šæ‰¾åˆ°äº†æ—§çš„ YouTube ç½‘é¡µ, åœ¨ä¸€äº›ä¿®è¡¥ä¸‹, Annotations èƒ½æ­£å¸¸å·¥ä½œ,
ç°åœ¨æˆ‘ä»¬èƒ½å¤Ÿç›´æ¥çœ‹åˆ°æ­£ç¡®çš„æ•ˆæœ, è¿™ç»™è°ƒè¯•å¸¦æ¥äº†æå¤§çš„ä¾¿åˆ©.
æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æˆå“: https://github.com/USED255/youtube_annotations_hack

---

å¤±ä¸šé—²çš„æ²¡äº‹å¹²æˆ‘æŠŠ https://archive.omar.yt/youtubeannotations.tar.zstd ä¸‹è½½äº†ä¸‹æ¥å¹¶å¤„ç†æˆäº†ä¸€ä¸ªSQLiteæ•°æ®åº“
æŠŠç¨‹åºè¿‡äº†ä¸€é, ç°åœ¨æ›´å…·æœ‰å¥å£®æ€§.

---
- æ³¨é‡Š(Annotations): YouTube çš„åŠŸèƒ½
- SSA(Sub Station Alpha): å­—å¹•æ ¼å¼
- ASS(Advanced SubStation Alpha): å­—å¹•æ ¼å¼
- invidious(https://invidious.io/): å¼€æº YouTube å‰ç«¯
- Internet Archive(https://archive.org/): äº’è”ç½‘æ¡£æ¡ˆé¦†
---
æœ¬æ–‡ä»¶ç¬¬47è¡Œ: éšç€ Youtube çš„æ”¹ç‰ˆ invidious å·²ç»é€æ¸å˜å¾—ä¸å¯ç”¨
æœ¬æ–‡ä»¶49è‡³57è¡Œ: é—®é¢˜å·²è§£å†³, ä½†ä¸æ˜¯ CSS çš„é—®é¢˜, æ˜¯å­—ä½“çš„é—®é¢˜ğŸ˜…
---
"""

from Annotations2Sub._Convert import Convert
from Annotations2Sub._Sub import Event, Style, Sub
from Annotations2Sub.Annotations import Annotation, NotAnnotationsDocumentError, Parse
from Annotations2Sub.cli import Run
from Annotations2Sub.cli_utils import AnnotationsXmlStringToSub, GetAnnotationsUrl

__all__ = [
    "Run",
    "Parse",
    "Convert",
    "Annotation",
    "Sub",
    "Style",
    "Event",
    "NotAnnotationsDocumentError",
    "GetAnnotationsUrl",
    "AnnotationsXmlStringToSub",
]

from Annotations2Sub.i18n import _

Run.__doc__ = _(
    """# Run å‡½æ•°

```python
def Run(args: List[str] | None = None) -> Literal[0, 1] :
    ...
```

`Run` å‡½æ•°å®ç°äº†å‘½ä»¤è¡Œæ¥å£. å½“åœ¨å‘½ä»¤è¡Œè¿è¡Œç¨‹åºæ—¶, å‡½æ•°å…¥å‚ä¸º `None`,
argparse ä¼šä» "argv" ä¸­è·å–å‚æ•°, è‹¥ä¼ å…¥ "List[str]", åˆ™è¯¥ `List` å°±æ˜¯ "å‘½ä»¤è¡Œå‚æ•°".
æˆåŠŸè¿”å› `0`, å¤±è´¥è¿”å› `1`.

åœ¨ç¼–ç ä¸­è°ƒç”¨è¯¥å‡½æ•°ä¸»è¦ç”¨äºæµ‹è¯•.

## ä¾‹å­

```python
# src/Annotations2Sub/__main__.py

def main() -> NoReturn:
    sys.exit(Run())
```

```python
# src/tests/test_cli.py

def test_cli_failed():
    commands = f\"""0 0\"""

    for command in commands.splitlines():
        argv = command.split(" ")
        code = Run(argv)
        assert code == 1
```

"""
)

Parse.__doc__ = _(
    """# Parse å‡½æ•°

```python
def Parse(tree: Element) -> List[Annotation]:
    ...
```

`Parse` å‡½æ•°å¯ä»¥å°† XML æ ‘è½¬æ¢ä¸º `Annotation` åˆ—è¡¨.

## ä¾‹å­

```python
# src/Annotations2Sub/cli_utils.py

tree = xml.etree.ElementTree.fromstring(annotations_string)
annotations = Parse(tree)
```
"""
)